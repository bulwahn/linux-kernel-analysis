From ff794c196a49bd52195d21505450d1be9f7748b2 Mon Sep 17 00:00:00 2001
From: Lukas Bulwahn <lukas.bulwahn@gmail.com>
Date: Fri, 19 Apr 2019 09:50:15 +0200
Subject: [PATCH 006/171] events/core: annotate mutex_lock_double

To handle this warning:

kernel/events/core.c:11292:2: warning: releasing mutex 'dst_ctx->mutex' that was not held [-Wthread-safety-analysis]
        mutex_unlock(&dst_ctx->mutex);
        ^
kernel/events/core.c:11293:2: warning: releasing mutex 'src_ctx->mutex' that was not held [-Wthread-safety-analysis]
        mutex_unlock(&src_ctx->mutex);
        ^
---
 kernel/events/core.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/kernel/events/core.c b/kernel/events/core.c
index dc7dead2d2cc..cc09b095172c 100644
--- a/kernel/events/core.c
+++ b/kernel/events/core.c
@@ -10641,7 +10641,7 @@ perf_event_set_output(struct perf_event *event, struct perf_event *output_event)
 	return ret;
 }
 
-static void mutex_lock_double(struct mutex *a, struct mutex *b)
+static void mutex_lock_double(struct mutex *a, struct mutex *b) __acquires_mutex(a) __acquires_mutex(b)
 {
 	if (b < a)
 		swap(a, b);
-- 
2.17.1

