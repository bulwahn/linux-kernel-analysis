From 4bb95b081e224721b106daf7836284ea031927a2 Mon Sep 17 00:00:00 2001
From: Lukas Bulwahn <lukas.bulwahn@gmail.com>
Date: Sun, 12 May 2019 12:08:27 +0200
Subject: [PATCH 78/82] kernel/locking/mutex.c: mutex_{lock,unlock}: basic
 mutex functions need special annotation

Link: https://github.com/ClangBuiltLinux/thread-safety-analysis/issues/11
---
 kernel/locking/mutex.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/kernel/locking/mutex.c b/kernel/locking/mutex.c
index 4c2ff515a1d8..1b4f0656c387 100644
--- a/kernel/locking/mutex.c
+++ b/kernel/locking/mutex.c
@@ -249,7 +249,7 @@ static void __sched __mutex_lock_slowpath(struct mutex *lock);
  *
  * This function is similar to (but not equivalent to) down().
  */
-void __sched mutex_lock(struct mutex *lock)
+void __sched mutex_lock(struct mutex *lock) __no_thread_safety_analysis
 {
 	might_sleep();
 
@@ -704,7 +704,7 @@ static noinline void __sched __mutex_unlock_slowpath(struct mutex *lock, unsigne
  *
  * This function is similar to (but not equivalent to) up().
  */
-void __sched mutex_unlock(struct mutex *lock)
+void __sched mutex_unlock(struct mutex *lock) __no_thread_safety_analysis
 {
 #ifndef CONFIG_DEBUG_LOCK_ALLOC
 	if (__mutex_unlock_fast(lock))
-- 
2.17.1

